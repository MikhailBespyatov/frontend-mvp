import React, { useEffect, Fragment } from 'react';
import { isPointerEventsSupported, isTouchSupported } from './utils.js';
import { useMatchMedia } from './useMatchMedia.js';

const IS_BROWSER = typeof window !== 'undefined';
const SUPPORTS_TOUCH = IS_BROWSER && (isPointerEventsSupported() || isTouchSupported());
const Mq = ({ children, query = '', touch, onMatchChange }) => {
    const [queryMatches] = useMatchMedia(query);
    const touchPass = touch === undefined ? true : touch === SUPPORTS_TOUCH;
    const matches = touchPass && (!query || queryMatches);
    useEffect(() => {
        if (onMatchChange) {
            onMatchChange(matches);
        }
    }, [matches, onMatchChange]);
    return React.createElement(Fragment, null, matches && IS_BROWSER ? children : null);
};

export { Mq };
