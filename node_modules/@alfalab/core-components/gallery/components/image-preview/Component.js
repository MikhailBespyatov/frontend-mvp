Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var cn = require('classnames');
var hooks = require('@alfalab/hooks');
var context = require('../../context.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var cn__default = /*#__PURE__*/_interopDefaultLegacy(cn);

var styles = {"component":"gallery__component_1wvtn","active":"gallery__active_1wvtn","image":"gallery__image_1wvtn","preview":"gallery__preview_1wvtn","loading":"gallery__loading_1wvtn","brokenImageWrapper":"gallery__brokenImageWrapper_1wvtn","brokenIcon":"gallery__brokenIcon_1wvtn","focused":"gallery__focused_1wvtn"};
require('./index.css');

var ImagePreview = function (_a) {
    var _b, _c;
    var image = _a.image, _d = _a.active, active = _d === void 0 ? false : _d, index = _a.index, onSelect = _a.onSelect, className = _a.className;
    var imagesMeta = React.useContext(context.GalleryContext).imagesMeta;
    var ref = React.useRef(null);
    var handleClick = function () {
        onSelect(index);
    };
    var handleKeyDown = function (event) {
        if (event.key === 'Enter') {
            onSelect(index);
        }
    };
    var focused = hooks.useFocus(ref, 'keyboard')[0];
    var meta = imagesMeta[index];
    var isBroken = Boolean(meta === null || meta === void 0 ? void 0 : meta.broken);
    return (React__default['default'].createElement("div", { className: cn__default['default'](styles.component, (_b = {}, _b[styles.active] = active, _b[styles.focused] = focused, _b), className), onClick: handleClick, role: 'button', onKeyDown: handleKeyDown, tabIndex: 0, ref: ref, "aria-label": "\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043A \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044E " + (index + 1) }, isBroken ? (React__default['default'].createElement("div", { className: cn__default['default'](styles.preview, styles.brokenImageWrapper) },
        React__default['default'].createElement("div", { className: styles.brokenIcon }))) : (React__default['default'].createElement("div", { className: cn__default['default'](styles.preview, styles.image, (_c = {},
            _c[styles.broken] = isBroken,
            _c[styles.loading] = !meta,
            _c)), style: { backgroundImage: "url(" + image.src + ")" } }))));
};

exports.ImagePreview = ImagePreview;
